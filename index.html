<!DOCTYPE html>
<html lang="en">
<head>
  <title>Jeffrey E. Sun</title>
  <link rel="icon" type="image/x-icon" href="./images/favicon.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <div id="fb-root"></div>
  <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v18.0" nonce="6eIcl1gX"></script>
  <link rel="stylesheet" href="milligram.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Maitree&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Croissant+One&family=Merriweather&display=swap" rel="stylesheet">
  <script>
    function toggleMenuIfOpen() {
      console.log("Test.");
      let toggle = document.getElementById('menu-toggle');
      console.log(toggle.checked);
      if(document.getElementById('menu-toggle').checked === true)
      {
        document.getElementById('menu-toggle').checked = false;
      }
    }
  </script>
</head>
<body class="easy-reading">

<div class="container">
  <header class="sticky-menu">
    <span class ='nav-heading nav-brand'><a class="nav-brand" href="https://www.jeffreyesun.com">Jeffrey E. Sun</a></span>
    <input type ='checkbox' class = 'menu-toggle' id ='menu-toggle'>
    <nav class="header">
      <ul>
        <li class="menu-item"><a class="church-title" href="#home" onclick="toggleMenuIfOpen();">Home</a></li>
        <li class="menu-item"><a class="church-title" href="https://www.dropbox.com/scl/fi/ds70730fz9ws1n6tz7nul/CV.pdf?rlkey=qgni7v1zdmhj4a3f2jb7cn0s7" onclick="toggleMenuIfOpen();">CV</a></li>
        <li class="menu-item"><a class="church-title" href="#working_papers" onclick="toggleMenuIfOpen();">Research</a></li>
        <li class="menu-item"><a class="church-title" href="https://github.com/jeffreyesun" onclick="toggleMenuIfOpen();">Code</a></li>
      </ul>
    </nav>
    <label for='menu-toggle' class='menu-nav-toggle'>
      <span>  </span>
    </label>
  </header>
  <div id="home" class="about-us-div">
    
    <div id="my_details" class="details-container">
      <img id="reader" alt="Portrait of Jeffrey E. Sun" class="reader-image" src="./images/Jeffrey_Sun-6032.jpg">
      <div id="reader-bio" class="reader-bio-full">
          <h3 class="about-title">Jeffrey E. Sun</h3>
          <p class="about-body">I am a Ph.D. student in Economics at Princeton University.
            <br /><br />
                      I will be starting as Assistant Professor of Economics at the University of Toronto in the fall.
            <br /><br />
            My research applies tools from macroeconomics and trade to study the economic consequences of climate change.
            <br /><br />
            You can find my CV <a class="proper-link" href="https://www.dropbox.com/scl/fi/ds70730fz9ws1n6tz7nul/CV.pdf?rlkey=qgni7v1zdmhj4a3f2jb7cn0s7">here</a>.
            <br /><br />
            <b>Email:</b> <a href="mailto:jesun@princeton.edu">jesun@princeton.edu</a>
      </div>
    </div>

    <div id="reader-bio" class="reader-bio-mobile">
        <h3 class="about-title">Jeffrey E. Sun</h3>
        <p class="about-body">I am a Ph.D. student in Economics at Princeton University.
          <br /><br />
          I will be starting as Assistant Professor of Economics at the University of Toronto in the fall.
          <br /><br />
          My research applies tools from macroeconomics and trade to study the economic consequences of climate change.
          <br /><br />
          You can find my CV <a class="proper-link" href="https://www.dropbox.com/scl/fi/ds70730fz9ws1n6tz7nul/CV.pdf?rlkey=qgni7v1zdmhj4a3f2jb7cn0s7">here</a>.
          <br /><br />
          <b>Email:</b> <a href="mailto:jesun@princeton.edu">jesun@princeton.edu</a>
        </p>
    </div>
  </div>

  <div id="papers" class="services-class">
    <br />
  
    <hr class="forward-line" style="margin-bottom: 1ex;" />
    <h3 class="forward-title" style="margin-bottom: 0cm;" ><b>Job Market Paper</b></h3>
    <h3 class="forward-title"><a class="proper-link" href="https://www.jeffreyesun.com/jmp.pdf"><b></b>“The Distributional Consequences of Climate Change: The Role of Housing Wealth, Expectations, and Uncertainty”</b></a></h3>
    <h3 class="forward-title" style="margin-top: 0cm;"><a class="proper-link" href="https://github.com/jeffreyesun/job-market-paper-code"><b></b>Code</b></a></h3>


    <p class="forward">The median US household holds a majority of its wealth in a single climate-exposed asset: the home. I study the implications of this fact for the distributional consequences of climate change, using a dynamic, stochastic, heterogeneous-agent model with 1713 locations. Forward-looking equilibrium real estate prices and rents endogenously respond to climate news shocks in spatially-segmented markets. Households participate on both sides of each market. To quantify climate impacts on economic fundamentals, I harmonize recent estimates of local productivity, amenities, energy costs, and disaster damage sensitivities. I find the model's global solution under aggregate climate uncertainty with a simple but general deep learning method introduced in a companion paper. In the calibrated model, a switch from widespread climate denial to widespread climate acceptance causes an effective transfer of housing wealth across regions of $41bn immediately and $507bn over the following century. Migration exacerbates this by amplifying housing price responses. The spatially-equalizing effects of migration only dominate for all households 50 years post-shock. Climate uncertainty causes ongoing regressive wealth transfers through higher equilibrium rents, borne mostly by poorer households.</p>
</div>

  <br />
  
  <!--
  <p type="button" class="collapsible">Interactive Model Results</p>
  <div class="collapsible-content">
    <p>Coming Soon!</p>
  </div>
  <br />
  -->
  
  <p type="button" class="collapsible">Numerical Methods Overview</p>
  <div id="working_papers" class="collapsible-content">
    <p>The primary numerical methods contribution in this paper is a new deep learning method for solving heterogeneous-agent models with aggregate uncertainty. This method uses neural networks to predict the conditional continuation values resulting from household actions, but does not use neural networks to approximate household policy functions. Details of this methodology are available in a <a href="https://www.jeffreyesun.com/CV_is_all_you_need.pdf">companion paper</a>.</p>
    <p>The key insight of the deep learning method is that, if a household knows the current utility and continuation values resulting from any action, then conventional methods can be used to solve the policy function. With one or two dimensions of heterogeneity, this is generally no problem. But because the model has so many individual states (213 million), I had to develop a few custom algorithms.</p>
    <p>These supplementary algorithms overcome some computational bottlenecks when scaling up discrete-time heterogeneous-agent models to large numbers of individual states and locations. In the hope that someone finds them useful, I've made a separate Github repository for them, in highly-optimized parallelized Julia code.</p>
    <ul>
      <li><a href="https://github.com/jeffreyesun/job-market-paper-code/blob/main/fast_algoithms.jl">All-at-once interpolating functions and distributions on endogenous gridpoints</a></li>
    </ul>
    <p>Speedup factor: log n (n = #(gridpoints), relative to individual lookups)</p>
    <p>When solving value functions using backwards induction or simulating distributions forward, if the gridpoints are defined in terms of endogenous quantities (e.g. wealth), you often have to reinterpolate the function or distribution back onto the grid. Existing interpolation libraries look up each gridpoint independently. With n gridpoints, each query is O(log n) and the whole reinterpolation is O(n log n). But if the grid is monotonic, you only need to iterate over each grid once, which you can do in O(n) time.</p>
    <p>Reinterpolating is slightly different for functions and distributions, since distribution approximations depend on the density of gridpoints.</p>
    <ul>
      <li><a href="https://github.com/jeffreyesun/job-market-paper-code/blob/main/fast_algoithms.jl">Computing choice probabilities for heterogeneous agents with a single matrix multiplication</a></li>
    </ul>
    <p>Speedup factor: up to n<sup>0.62</sup> or so, with big improvement on constant (if n = #(locations), relative to naive approach)</p>
    <p>With n locations and m possible within-location agent states, if agents receive Gumbel-distributed location preferences, then to solve for the value function and choice probabilities, you have to solve for n*n*m possible agent-choice pairs. Luckily, this can be constructed as a single matrix multiplication, which can even be done non-allocatingly if set up properly. Highly-optimized linear algebra libraries can then be used.</p>
    <ul>
      <li><a href="https://github.com/jeffreyesun/job-market-paper-code/blob/main/fast_algoithms.jl">All-at-once solving monotone decision function for heterogenous agents</a></li>
    </ul>
    <p>Speedup factor: n (n = #(gridpoints), relative to naive individual lookups. Speedup factor log n over optimized individual lookups)</p>
    <p>In many models, agents must make consumption savings decisions. Assuming a discretized wealth grid, the most flexible solution is to maximize over all possible continuation values for each agent, but this requires O(n<sup>2</sup>) total computations. If both continuation value and optimal saving are increasing in wealth, each agent needs only consider possible choices that lie between the choices of adjacent agents. By using binary search for individual lookups and a form of modified binary search to constrain the search space for individual agents, we can compute the optimal decisions of n agents who differ only by wealth using only 2n computations.</p>
  </div>

  <hr class="forward-line" />
  
  <script>
  var coll = document.getElementsByClassName("collapsible");
  var i;
  
  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.maxHeight){
        content.style.maxHeight = null;
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
      } 
    });
  }
  </script>
  <h2 class="about-title">Working Papers</h2>
  <ul>
    <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/jmp.pdf"><b>The Distributional Consequences of Climate Change: The Role of Housing Wealth, Expectations, and Uncertainty</b></a>, Job Market Paper</li>
      <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/CV_is_all_you_need.pdf"><b>Continuation Value Is All You Need: A Deep Learning Method for Solving Heterogeneous-Agent Models With Aggregate Uncertainty</b></a></li>
    <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/RPS.pdf"><b>Indirect Effects of Renewable Portfolio Standards on Carbon Emissions</b></a></li>
  </ul>
  <hr class="forward-line" />

  <h2 class="about-title">Work in Progress</h2>
  <ul>
    <li class="paper-title"><b>Learning From Coworkers in General Equilibirum: Worker Sorting and the Rise of Inequality</b> (with
      Gregor Jarosch, Ezra Oberfield, and Esteban Rossi-Hansberg)</li>
  </ul>
  <hr class="forward-line" />

  <h2 class="about-title">Computational Notes</h2>
  <ul>
    <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/conventional_methods.pdf"><b>Atomistic Agents</b></a></li>
    <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/auto_implicit_diff.pdf"><b>Granular Agents (Market Power, Optimal Policy, etc.)</b></a></li>
    <li class="paper-title"><a class="proper-link" href="https://www.jeffreyesun.com/CV_is_all_you_need.pdf"><b>Global Solution</b></a></li>
  </ul>
  <hr class="forward-line" />

  <h2 class="about-title">From a Previous Life</h2>
  <h3 class="about-header"><b>Mathematics Publications</b></h3>
  <ul>
    <li class="paper-title">Bora, S., Damelin, S., Kaiser, D., & Sun, J. (2023), An algebraic-coding equivalence to the maximum distance separable conjecture, Involve, a Journal of Mathematics, Forthcoming.</li>
    <li class="paper-title">G&uuml;nt&uuml;rk&uuml;n, S., Jeffries, J., & Sun, J. (2020). Polarization of neural rings. Journal of Algebra and Its Applications, 19(08), 2050146.</li>
    <li class="paper-title">Hua, M., Damelin, S. B., Sun, J., & Yu, M. (2017). The truncated and supplemented Pascal matrix and applications. Involve, a Journal of Mathematics, 11(2), 243-251</li>
  </ul>
  
  <div id="contact_us" class="contact-us-div">
    <div class="contact-div">
      <br>
      <p class="info-atom" style="margin-top:1.5cm;">Copyright 2023 Jeffrey Sun</p>
    </div>
  </div>
</div>

</body>
</html>
